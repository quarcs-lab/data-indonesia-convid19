write.table(hp, "outputgap.csv", sep = ";", col.names = NA,
qmethod = "double")
hpcycle <- select(hp, contains("cycleHP"))
hpcycle <- select(hp, contains("cycleHP" & "time"))
hpcycle <- select(hp, matches("cycleHP" | "time"))
hpcycle <- select(hp, matches('cycleHP | time'))
View(hpcycle)
hpcycle <- select(hp, matches('cycleHP'))
hpcycle <- select(hp, contains('cycleHP'))
hpcycle <- select(hp, contains("cycleHP"))
View(hpcycle)
hpcycle <- select(hp, matches("cycleHP" | "time"))
hpcycle <- select(hp, contains("cycleHP" | "time"))
hpcycle <- select(hp, c((1) & contains("cycleHP")))
hpcycle <- select(hp, contains("cycleHP"))
hpcycle <- select(hp, contains("cycleHP"))
hpcycle <- right_join(hpcycle, time1)
hpcycle <- select(hp, contains("cycleHP"))
hpcycle <- merge(hpcycle, time1)
hpcycle <- select(hp, contains("cycleHP"))
hpcycle <- merge(hpcycle, time1)
View(hpcycle)
hpcycle <- select(hp, contains("cycleHP"))
#hpcycle <- merge(hpcycle, time1)
View(hp)
View(time1)
hpcycle <- select(hp, -contains("actual" | "trendHP"))
hpcycle <- select(hp, -contains("actual" & "trendHP"))
hpcycle <- select(hp, -contains("actual"))
hpcycle <- select(hp, -contains("actual")) %>%
select(-contains("trendHP"))
filter (hpcycle, time1 == "2020_q2")
q2_2020hp <- filter (hpcycle, time1 == "2020_q2")
View(q2_2020hp)
plot(q2_2020hp)
plot(q2_2020hp, x= "time")
View(lngdp)
pivot_longer(hpcycle, -c(time), values_to = gap, names_to = province)
pivot_longer(hpcycle, -c(time), values_to = gap, names_to = values)
pivot_longer(hpcycle, -c(time), values_to = gap, names_to = "province" )
pivot_longer(hpcycle, -c(time), values_to = "gap", names_to = "province" )
long_hp <- pivot_longer(hpcycle, -c(time), values_to = "gap", names_to = "province" )
long_hp <- pivot_longer(hpcycle, -c(time), values_to = "gap", names_to = "Province" )
long_hp <- pivot_longer(hpcycle, -c(time), values_to = "gap", names_to = "province" )
View(long_hp)
long_hp <- long_hp %>% mutate(province = as.character(gsub("_cycleHP", "", province)))
long_hp <- pivot_longer(hpcycle, -c(time), values_to = "output_gap", names_to = "province" )
long_hp <- long_hp %>% mutate(province = as.character(gsub("_cycleHP", "", province)))
ggplot(long_hp, (time, output_gap))
ggplot(long_hp, aes(time, output_gap))
ggplot(long_hp, aes(time, output_gap))
geom_line()
ggplot(long_hp, aes(time, output_gap, color = province))
geom_line()
ggplot(long_hp, aes(time, output_gap, color = province))
geom_line()
ggplot(long_hp, aes(time, output_gap, color = "province"))
geom_line()
graph <- long_hp %>%
ggplot(aes(x = time, y = output_gap, color= province)) +
geom_line(size=0.5) +
labs(subtitle = "Consumer Price Index at Province Level, 2012-2019",
x = "Time",
y = "CPI", color="") + theme_bw() +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
graph
graph <- long_hp %>%
ggplot(aes(x = time, y = output_gap, color= province)) +
geom_line(size=0.5) +
labs(subtitle = "Output Gap, 2012-2019",
x = "Time",
y = "Output gap", color="") + theme_bw() +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
graph
View(q2_2020hp)
q2_2020hp <- filter(long_hp, time = "2020_q2")
q2_2020hp <- filter(long_hp, time == "2020_q2")
View(q2_2020hp)
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Change in people mobility relative to baseline", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
oututgap
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Change in people mobility relative to baseline", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
#ggsave("mobility.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2 2020", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
#ggsave("mobility.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2 2020", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
ggsave("outputgap.png", width = 9, height = 5)
library(mFilter)
library(dplyr)
library(ggplot2)
library(dygraphs)
library(xts)
library(readxl)
library(quantmod)
library(neverhpfilter)
options(prompt="R> ", digits=3, scipen=999)
library(readxl)
mydata <- read_excel("Output gap_quarterly.xlsx")
mydata
library(tidyr)
mydata$GRDP = as.numeric(mydata$GRDP)
library(reshape2)
data_w <- dcast(mydata, Time ~ Province, value.var = "GRDP")
data_w
mydatats <- ts(data_w[,2:35], start =c(2010,1), frequency = 4)
mydatats
str(mydatats)
View(mydatats)
lngdp <- 100*log(mydatats)
View(lngdp)
par(mfrow=c(1,2))
plot(mydatats[,1], xlab="", ylab="", main="Aceh GDP level")
plot(lngdp[,1], xlab="", ylab="", main="Aceh GDP logs")
par(mfrow=c(1,1))
library(dygraphs)
dygraph(lngdp[,1]) %>%
dyRangeSelector()
year = rep(2010:2019, each =4)
year
quarter = rep(c("q1", "q2", "q3", "q4"), 10)
quarter
time <- paste(year, quarter, sep = "_")
time
hp <- data.frame(time)
hp <- rbind(hp, c("2020_q1")) %>%
rbind(c("2020_q2"))
hp
lngdp1 <- data.frame(hp, lngdp)
hp1 <- data.frame(data_w$Time)
hp1
time1 <- data.frame(time=lngdp1[,1])
time1
for (i in 2:35) {
hpfil <- hpfilter(lngdp1[,i], freq = 1600)
actual <- hpfil[["x"]]
trendHP <- hpfil[["trend"]]
cycleHP <- actual - trendHP
colnames(actual) <- c(paste(colnames(lngdp1)[i],"actual",sep = "_"))
colnames(trendHP) <- c(paste(colnames(lngdp1)[i],"trendHP",sep = "_"))
colnames(cycleHP) <- c(paste(colnames(lngdp1)[i],"cycleHP",sep = "_"))
actual_trend_cycle <- data.frame(actual, trendHP, cycleHP, time1)
hp <- left_join(hp, actual_trend_cycle, by = "time")
}
View(hp)
write.table(hp, "outputgap.csv", sep = ";", col.names = NA,
qmethod = "double")
for (i in 2:36) {
hpfil <- hpfilter(lngdp1[,i], freq = 1600)
actual <- hpfil[["x"]]
trendHP <- hpfil[["trend"]]
cycleHP <- actual - trendHP
colnames(actual) <- c(paste(colnames(lngdp1)[i],"actual",sep = "_"))
colnames(trendHP) <- c(paste(colnames(lngdp1)[i],"trendHP",sep = "_"))
colnames(cycleHP) <- c(paste(colnames(lngdp1)[i],"cycleHP",sep = "_"))
actual_trend_cycle <- data.frame(actual, trendHP, cycleHP, time1)
hp <- left_join(hp, actual_trend_cycle, by = "time")
}
library(mFilter)
library(dplyr)
library(ggplot2)
library(dygraphs)
library(xts)
library(readxl)
library(quantmod)
library(neverhpfilter)
library(readxl)
mydata <- read_excel("Output gap_quarterly.xlsx")
mydata
hp <- data.frame(time)
hp <- rbind(hp, c("2020_q1")) %>%
rbind(c("2020_q2"))
hp
lngdp1 <- data.frame(hp, lngdp)
View(lngdp1)
View(lngdp)
mydatats <- ts(data_w[,2:36], start =c(2010,1), frequency = 4)
mydatats
lngdp <- 100*log(mydatats)
View(lngdp)
par(mfrow=c(1,2))
plot(mydatats[,1], xlab="", ylab="", main="Aceh GDP level")
plot(lngdp[,1], xlab="", ylab="", main="Aceh GDP logs")
par(mfrow=c(1,1))
year = rep(2010:2019, each =4)
year
quarter = rep(c("q1", "q2", "q3", "q4"), 10)
quarter
time <- paste(year, quarter, sep = "_")
time
hp <- data.frame(time)
hp <- rbind(hp, c("2020_q1")) %>%
rbind(c("2020_q2"))
hp
lngdp1 <- data.frame(hp, lngdp)
time1 <- data.frame(time=lngdp1[,1])
time1
for (i in 2:36) {
hpfil <- hpfilter(lngdp1[,i], freq = 1600)
actual <- hpfil[["x"]]
trendHP <- hpfil[["trend"]]
cycleHP <- actual - trendHP
colnames(actual) <- c(paste(colnames(lngdp1)[i],"actual",sep = "_"))
colnames(trendHP) <- c(paste(colnames(lngdp1)[i],"trendHP",sep = "_"))
colnames(cycleHP) <- c(paste(colnames(lngdp1)[i],"cycleHP",sep = "_"))
actual_trend_cycle <- data.frame(actual, trendHP, cycleHP, time1)
hp <- left_join(hp, actual_trend_cycle, by = "time")
}
View(hp)
write.table(hp, "outputgap.csv", sep = ";", col.names = NA,
qmethod = "double")
hpcycle <- select(hp, -contains("actual")) %>%
select(-contains("trendHP"))
long_hp <- pivot_longer(hpcycle, -c(time), values_to = "output_gap", names_to = "province" )
long_hp <- long_hp %>% mutate(province = as.character(gsub("_cycleHP", "", province)))
graph <- long_hp %>%
ggplot(aes(x = time, y = output_gap, color= province)) +
geom_line(size=0.5) +
labs(subtitle = "Output Gap, 2012-2019",
x = "Time",
y = "Output gap", color="") + theme_bw() +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
graph
q2_2020hp <- filter(long_hp, time == "2020_q2")
outputgap <- ggplot(q2_2020hp, aes(reorder(province, -output_gap, sum), output_gap)) +
geom_col() + coord_flip() +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
ggsave("outputgap.png", width = 9, height = 5)
ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "Normal") )) +
geom_bar(stat = "identity") +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "Normal") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8)) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +  coord_flip(expand = FALSE) +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
guides(col = guide_legend(nrow = 8))
outputgap
ggsave("outputgap.png", width = 9, height = 5)
ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank() +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)", color="grey") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, -output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "grey") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, -output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "red") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "Province",
y = "Provincial output gap in Q2-2020 (%)") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
outputgap <- ggplot(q2_2020hp,
aes(x = reorder(province, -output_gap),
y = output_gap,
fill = ifelse(province == "Indonesia", "Highlighted", "red") )) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(subtitle = "",
x = "",
y = "Output gap in Q2-2020 (%)") +
theme(text=element_text( family="Palatino")) +
## drop legend and Y-axis title
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position = "none", axis.title.y = element_blank()) +
coord_flip(expand = FALSE) ########## SMALL UPDATE
outputgap
ggsave("outputgap.png", width = 9, height = 5)
